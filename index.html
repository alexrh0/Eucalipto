<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Historia del Eucalipto</title>
    <style>
        /* Estilos básicos */
        body, html {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            overflow-x: hidden;
        }

        /* Contenedor general del video */
        .video-layer {
            position: relative;
            width: 100%;
            height: 100vh;
            z-index: -1;
        }

        .background-video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Estilos para los textos */
        #intro-text, #instructions, #story-form {
            color: black;
            position: relative;
            text-align: center;
            z-index: 2;
            background: transparent;
        }

        #intro-text {
            font-size: 40px;
            font-weight: bold;
            padding: 20px;
            margin-bottom: 20px;
        }

        #instructions {
            font-size: 20px;
            padding: 20px;
            margin-bottom: 20px;
        }

        #story-form {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        #story-form input[type="text"], #story-form textarea {
            width: 70%;
            padding: 10px;
            margin-bottom: 10px;
            font-size: 16px;
        }

        #story-form input[type="submit"] {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #28a745;
            color: white;
            border: none;
            cursor: pointer;
            margin-bottom: 20px;
        }

        /* Para mantener los textos centrados y flotando */
        .floating-content {
            position: absolute;
            top: 20%;
            width: 100%;
            z-index: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Contenedor para mostrar las historias */
        #story-container {
            position: relative;
            z-index: 2;
            text-align: center;
            margin-top: 20px;
        }

        /* Video adicional para que nunca haya fondo blanco */
        .video-layer.extra {
            position: absolute;
            top: 100vh;
            width: 100%;
            height: 100vh;
            z-index: -1;
        }
    </style>
</head>
<body>
    <!-- Primera capa de video -->
    <div class="video-layer">
        <video class="background-video" autoplay loop muted>
            <source src="corteza.mp4" type="video/mp4">
            Tu navegador no soporta la reproducción de videos.
        </video>
    </div>

    <!-- Segunda capa de video -->
    <div class="video-layer extra">
        <video class="background-video" autoplay loop muted>
            <source src="corteza.mp4" type="video/mp4">
            Tu navegador no soporta la reproducción de videos.
        </video>
    </div>

    <!-- Contenido flotante sobre los videos -->
    <div class="floating-content">
        <div id="intro-text">
            5 de agosto 2024, Plazuela Ricardo Flores Magón, Ayuntamiento 1985-1988, Cuernavaca Morelos. Mi cuerpo ha dado todo lo que puede, me desmorono como la corteza del eucalipto que me cubre del sol. Caminé tanto para llegar a este punto, un sitio que es atravesado por un momento que marcó la vida de alguien más. Si observas bien encuentras basura de temporalidades distintas, de historias que me permiten conocer este lugar, ¿Qué es lo que me dicen?
        </div>
        <div id="instructions">
            Ve hasta abajo y lee la última entrada para continuar con la historia. Escribe la fecha y el lugar donde te encuentras a modo de diario. El texto puede ser verídico o ficción, todo gira alrededor del eucalipto.
        </div>
        <div id="story-form">
            <form id="storyForm">
                <input type="text" id="storyDate" placeholder="Escribe la fecha y el lugar" required>
                <textarea id="storyInput" placeholder="Escribe tu parte de la historia..." rows="4" required></textarea>
                <input type="submit" value="Agregar">
            </form>
        </div>
    </div>

    <!-- Contenedor para las historias -->
    <div id="story-container"></div>

    <!-- Firebase JS SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>

    <script>
        // Configuración de Firebase (usando los datos que proporcionaste)
        const firebaseConfig = {
            apiKey: "AIzaSyALU0CKvrJmDzm_J_9MzReSlYHetf4J8ls",
            authDomain: "textos-eucalipto.firebaseapp.com",
            databaseURL: "https://textos-eucalipto-default-rtdb.firebaseio.com",
            projectId: "textos-eucalipto",
            storageBucket: "textos-eucalipto.appspot.com",
            messagingSenderId: "482450709158",
            appId: "1:482450709158:web:d65b718e4b0ae2f55cf267",
            measurementId: "G-SF74G8005B"
        };

        // Inicializa Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // Cargar historias desde Firebase
        function loadStories() {
            const storyContainer = document.getElementById('story-container');
            db.ref('historias').on('value', (snapshot) => {
                storyContainer.innerHTML = ''; // Limpiar el contenedor antes de mostrar las historias
                snapshot.forEach((childSnapshot) => {
                    const story = childSnapshot.val().texto;
                    const newEntry = document.createElement('p');
                    newEntry.textContent = story;
                    storyContainer.appendChild(newEntry);
                });
            });
        }

        // Agregar nueva parte de la historia
        document.getElementById('storyForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const storyDate = document.getElementById('storyDate').value;
            const storyInput = document.getElementById('storyInput').value;

            if (storyDate.trim() !== "" && storyInput.trim() !== "") {
                const newStory = `${storyDate}: ${storyInput}`;

                db.ref('historias').push({
                    texto: newStory,
                    timestamp: Date.now()
                });

                document.getElementById('storyDate').value = "";
                document.getElementById('storyInput').value = "";
            }
        });

        // Cargar historias cuando se carga la página
        window.onload = loadStories;
    </script>
</body>
</html>
